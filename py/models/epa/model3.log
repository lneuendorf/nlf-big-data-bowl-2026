Endcoded dist to endzone and endzone approach rate as node features.

Loading weekly data: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 18/18 [00:07<00:00,  2.41it/s]
2025-12-13 13:44:50,757 - INFO - Tracking input shape: (4880579, 23), output shape: (562936, 6)
2025-12-13 13:44:56,926 - INFO - Joined input and output tracking data: 14108 unique plays, 1384 unique nfl_ids
2025-12-13 13:44:56,926 - INFO - Standardizing direction of play and players to be left to right
2025-12-13 13:44:58,007 - INFO - Approximating missing speed, acceleration and direction values
2025-12-13 13:45:00,277 - INFO - Correlation results for imputations: s_approx: speed R²=0.9897 | a_approx: accel R²=0.0445 | dir_approx: dir R²=0.0442
2025-12-13 13:45:00,868 - INFO - Joining supplemental data to plays DataFrame
2025-12-13 13:45:00,898 - INFO - Loading NFL PBP data for season 2023
2025-12-13 13:45:00,898 - INFO - Loading pbp from local parquet file
2025-12-13 13:45:01,144 - INFO - Mapping player IDs to nfl_id using seasonal rosters
2025-12-13 13:45:01,144 - INFO - Rosters for season 2023 already cached, loading from parquet
2025-12-13 13:45:13,902 - WARNING - Dropping gpid 2023091001_3216 with no passer and no QB
2025-12-13 13:45:14,437 - INFO - Defaulting passer to QB for play without a passer: 2023102208_2326
2025-12-13 13:45:15,589 - WARNING - Dropping gpid 2023091002_599 with no passer and no QB
2025-12-13 13:45:16,135 - INFO - Defaulting passer to QB for play without a passer: 2023121600_1352
2025-12-13 13:45:17,365 - INFO - Defaulting passer to QB for play without a passer: 2023123108_1819
2025-12-13 13:45:18,618 - WARNING - Dropping gpid 2023111905_2752 with no passer and no QB
2025-12-13 13:45:19,176 - INFO - Defaulting passer to QB for play without a passer: 2023100801_391
2025-12-13 13:45:20,309 - INFO - Defaulting passer to QB for play without a passer: 2023100105_3337
2025-12-13 13:45:21,440 - INFO - Defaulting passer to QB for play without a passer: 2023100107_1374
2025-12-13 13:45:22,572 - INFO - Defaulting passer to QB for play without a passer: 2023101200_2306
2025-12-13 13:45:23,776 - WARNING - Dropping gpid 2023112606_4180 with no passer and no QB
2025-12-13 13:45:24,336 - WARNING - Dropping gpid 2023121009_3594 with no passer and no QB
2025-12-13 13:45:24,910 - INFO - Defaulting passer to QB for play without a passer: 2023102907_281
2025-12-13 13:45:26,093 - INFO - Defaulting passer to QB for play without a passer: 2023092406_3048
2025-12-13 13:45:27,229 - INFO - Defaulting passer to QB for play without a passer: 2023121400_1904
2025-12-13 13:45:28,461 - INFO - Defaulting passer to QB for play without a passer: 2023111203_1068
2025-12-13 13:45:29,657 - INFO - Defaulting passer to QB for play without a passer: 2023121400_2596
2025-12-13 13:45:30,904 - INFO - Defaulting passer to QB for play without a passer: 2023122407_1051
2025-12-13 13:45:32,132 - INFO - Estimating ball path for each play
2025-12-13 13:45:32,514 - WARNING - Dropping gpid 2023092406_3048 with 0 passers and 1 receivers
2025-12-13 13:45:32,534 - WARNING - Dropping gpid 2023100105_3337 with 0 passers and 1 receivers
2025-12-13 13:45:32,536 - WARNING - Dropping gpid 2023100107_1374 with 0 passers and 1 receivers
2025-12-13 13:45:32,552 - WARNING - Dropping gpid 2023100801_391 with 0 passers and 1 receivers
2025-12-13 13:45:32,568 - WARNING - Dropping gpid 2023101200_2306 with 0 passers and 1 receivers
2025-12-13 13:45:32,601 - WARNING - Dropping gpid 2023102208_2326 with 0 passers and 1 receivers
2025-12-13 13:45:32,618 - WARNING - Dropping gpid 2023102907_281 with 0 passers and 1 receivers
2025-12-13 13:45:32,653 - WARNING - Dropping gpid 2023111203_1068 with 0 passers and 1 receivers
2025-12-13 13:45:32,748 - WARNING - Dropping gpid 2023121400_1904 with 0 passers and 1 receivers
2025-12-13 13:45:32,748 - WARNING - Dropping gpid 2023121400_2596 with 0 passers and 1 receivers
2025-12-13 13:45:32,749 - WARNING - Dropping gpid 2023121600_1352 with 0 passers and 1 receivers
2025-12-13 13:45:32,805 - WARNING - Dropping gpid 2023123108_1819 with 0 passers and 1 receivers
2025-12-13 13:45:52,376 - INFO - Finished estimating ball path for 14091 plays
2025-12-13 13:45:55,224 - INFO - Loading team description info from cached parquet.
2025-12-13 13:45:55,359 - INFO - Dropping 2 plays with >4.0s ball airtime
2025-12-13 13:45:59,073 - INFO - Defender dataset built: 31895 rows, 12 cols
2025-12-13 13:45:59,209 - INFO - Trained model artifacts found.
2025-12-13 13:45:59,228 - INFO - Loaded model and metadata from /Users/lukeneuendorf/projects/nfl-big-data-bowl-2026/data/models/defender_reach
Filtering plays with over 4 defenders: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 126/126 [00:00<00:00, 211.58it/s]
2025-12-13 13:45:59,944 - INFO - Dropping 1400 plays with no defenders within 10 yards of the pass landing point
2025-12-13 13:46:04,435 - INFO - Final number of pass plays: 12691
Preparing samples for EPA model: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12691/12691 [01:37<00:00, 129.90it/s]
2025-12-13 13:47:42,144 - INFO - Starting model training
2025-12-13 13:47:44,367 - INFO - Epoch 01 | Train Loss: 0.809 | Val Loss: 0.793
2025-12-13 13:47:46,595 - INFO - Epoch 02 | Train Loss: 0.735 | Val Loss: 0.775
2025-12-13 13:47:48,732 - INFO - Epoch 03 | Train Loss: 0.691 | Val Loss: 0.699
2025-12-13 13:47:50,977 - INFO - Epoch 04 | Train Loss: 0.667 | Val Loss: 0.675
2025-12-13 13:47:53,199 - INFO - Epoch 05 | Train Loss: 0.639 | Val Loss: 0.670
2025-12-13 13:47:55,361 - INFO - Epoch 06 | Train Loss: 0.620 | Val Loss: 0.657
2025-12-13 13:47:57,636 - INFO - Epoch 07 | Train Loss: 0.605 | Val Loss: 0.620
2025-12-13 13:47:59,912 - INFO - Epoch 08 | Train Loss: 0.593 | Val Loss: 0.625
2025-12-13 13:48:02,211 - INFO - Epoch 09 | Train Loss: 0.589 | Val Loss: 0.602
2025-12-13 13:48:04,433 - INFO - Epoch 10 | Train Loss: 0.574 | Val Loss: 0.605
2025-12-13 13:48:06,671 - INFO - Epoch 11 | Train Loss: 0.562 | Val Loss: 0.610
2025-12-13 13:48:08,863 - INFO - Epoch 12 | Train Loss: 0.555 | Val Loss: 0.589
2025-12-13 13:48:11,133 - INFO - Epoch 13 | Train Loss: 0.556 | Val Loss: 0.586
2025-12-13 13:48:13,438 - INFO - Epoch 14 | Train Loss: 0.535 | Val Loss: 0.582
2025-12-13 13:48:15,680 - INFO - Epoch 15 | Train Loss: 0.535 | Val Loss: 0.584
2025-12-13 13:48:17,972 - INFO - Epoch 16 | Train Loss: 0.530 | Val Loss: 0.610
2025-12-13 13:48:20,245 - INFO - Epoch 17 | Train Loss: 0.525 | Val Loss: 0.572
2025-12-13 13:48:22,488 - INFO - Epoch 18 | Train Loss: 0.517 | Val Loss: 0.576
2025-12-13 13:48:24,674 - INFO - Epoch 19 | Train Loss: 0.518 | Val Loss: 0.587
2025-12-13 13:48:26,977 - INFO - Epoch 20 | Train Loss: 0.512 | Val Loss: 0.564
2025-12-13 13:48:29,216 - INFO - Epoch 21 | Train Loss: 0.505 | Val Loss: 0.556
2025-12-13 13:48:31,462 - INFO - Epoch 22 | Train Loss: 0.503 | Val Loss: 0.570
2025-12-13 13:48:33,665 - INFO - Epoch 23 | Train Loss: 0.504 | Val Loss: 0.582
2025-12-13 13:48:35,802 - INFO - Epoch 24 | Train Loss: 0.498 | Val Loss: 0.583
2025-12-13 13:48:38,037 - INFO - Epoch 25 | Train Loss: 0.491 | Val Loss: 0.557
2025-12-13 13:48:40,217 - INFO - Epoch 26 | Train Loss: 0.490 | Val Loss: 0.544
2025-12-13 13:48:42,467 - INFO - Epoch 27 | Train Loss: 0.480 | Val Loss: 0.559
2025-12-13 13:48:44,655 - INFO - Epoch 28 | Train Loss: 0.483 | Val Loss: 0.553
2025-12-13 13:48:46,879 - INFO - Epoch 29 | Train Loss: 0.480 | Val Loss: 0.562
2025-12-13 13:48:49,131 - INFO - Epoch 30 | Train Loss: 0.481 | Val Loss: 0.550
2025-12-13 13:48:51,348 - INFO - Epoch 31 | Train Loss: 0.470 | Val Loss: 0.537
2025-12-13 13:48:53,611 - INFO - Epoch 32 | Train Loss: 0.471 | Val Loss: 0.549
2025-12-13 13:48:55,881 - INFO - Epoch 33 | Train Loss: 0.468 | Val Loss: 0.551
2025-12-13 13:48:58,134 - INFO - Epoch 34 | Train Loss: 0.461 | Val Loss: 0.572
2025-12-13 13:49:00,381 - INFO - Epoch 35 | Train Loss: 0.463 | Val Loss: 0.540
2025-12-13 13:49:02,594 - INFO - Epoch 36 | Train Loss: 0.454 | Val Loss: 0.546
2025-12-13 13:49:02,594 - INFO - Early stopping triggered at epoch 36.
2025-12-13 13:49:02,594 - INFO - Restored best model with val loss: 0.5373
2025-12-13 13:49:04,445 - INFO - ===== Final EPA Model Evaluation =====
2025-12-13 13:49:04,445 - INFO - Split             MAE     SmoothL1          MSE         RMSE
2025-12-13 13:49:04,445 - INFO - ------------------------------------------------------------
2025-12-13 13:49:04,445 - INFO - Train          0.7602       0.4480       1.6268       1.2755
2025-12-13 13:49:04,445 - INFO - Val            0.8672       0.5373       2.0901       1.4457
2025-12-13 13:49:04,445 - INFO - Test           0.9280       0.6007       2.3245       1.5246
2025-12-13 13:49:04,445 - INFO - ===== Baseline EPA Model Evaluation (Predicting Average EPA) =====
2025-12-13 13:49:04,445 - INFO - Split             MAE     SmoothL1          MSE         RMSE
2025-12-13 13:49:04,445 - INFO - ------------------------------------------------------------
2025-12-13 13:49:04,446 - INFO - All            1.2071       0.7900       2.7228       1.6501
2025-12-13 13:49:04,446 - INFO - Model training and evaluation complete, saving the model