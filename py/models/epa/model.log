Loading weekly data: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 18/18 [00:07<00:00,  2.29it/s]
2025-12-11 22:40:17,732 - INFO - Tracking input shape: (4880579, 23), output shape: (562936, 6)
2025-12-11 22:40:24,016 - INFO - Joined input and output tracking data: 14108 unique plays, 1384 unique nfl_ids
2025-12-11 22:40:24,017 - INFO - Standardizing direction of play and players to be left to right
2025-12-11 22:40:25,092 - INFO - Approximating missing speed, acceleration and direction values
2025-12-11 22:40:27,243 - INFO - Correlation results for imputations: s_approx: speed R²=0.9897 | a_approx: accel R²=0.0445 | dir_approx: dir R²=0.0442
2025-12-11 22:40:27,712 - INFO - Joining supplemental data to plays DataFrame
2025-12-11 22:40:27,742 - INFO - Loading NFL PBP data for season 2023
2025-12-11 22:40:27,742 - INFO - Loading pbp from local parquet file
2025-12-11 22:40:27,994 - INFO - Mapping player IDs to nfl_id using seasonal rosters
2025-12-11 22:40:27,994 - INFO - Rosters for season 2023 already cached, loading from parquet
2025-12-11 22:40:41,587 - WARNING - Dropping gpid 2023121009_3594 with no passer and no QB
2025-12-11 22:40:42,161 - INFO - Defaulting passer to QB for play without a passer: 2023102208_2326
2025-12-11 22:40:43,347 - INFO - Defaulting passer to QB for play without a passer: 2023100107_1374
2025-12-11 22:40:44,503 - INFO - Defaulting passer to QB for play without a passer: 2023102907_281
2025-12-11 22:40:45,696 - INFO - Defaulting passer to QB for play without a passer: 2023121600_1352
2025-12-11 22:40:46,939 - INFO - Defaulting passer to QB for play without a passer: 2023092406_3048
2025-12-11 22:40:48,086 - WARNING - Dropping gpid 2023111905_2752 with no passer and no QB
2025-12-11 22:40:48,677 - INFO - Defaulting passer to QB for play without a passer: 2023123108_1819
2025-12-11 22:40:50,029 - INFO - Defaulting passer to QB for play without a passer: 2023100801_391
2025-12-11 22:40:51,329 - WARNING - Dropping gpid 2023112606_4180 with no passer and no QB
2025-12-11 22:40:51,931 - INFO - Defaulting passer to QB for play without a passer: 2023121400_1904
2025-12-11 22:40:53,373 - INFO - Defaulting passer to QB for play without a passer: 2023100105_3337
2025-12-11 22:40:54,550 - INFO - Defaulting passer to QB for play without a passer: 2023121400_2596
2025-12-11 22:40:55,893 - INFO - Defaulting passer to QB for play without a passer: 2023101200_2306
2025-12-11 22:40:57,082 - WARNING - Dropping gpid 2023091001_3216 with no passer and no QB
2025-12-11 22:40:57,752 - WARNING - Dropping gpid 2023091002_599 with no passer and no QB
2025-12-11 22:40:58,358 - INFO - Defaulting passer to QB for play without a passer: 2023122407_1051
2025-12-11 22:40:59,647 - INFO - Defaulting passer to QB for play without a passer: 2023111203_1068
2025-12-11 22:41:00,845 - INFO - Estimating ball path for each play
2025-12-11 22:41:01,236 - WARNING - Dropping gpid 2023092406_3048 with 0 passers and 1 receivers
2025-12-11 22:41:01,257 - WARNING - Dropping gpid 2023100105_3337 with 0 passers and 1 receivers
2025-12-11 22:41:01,258 - WARNING - Dropping gpid 2023100107_1374 with 0 passers and 1 receivers
2025-12-11 22:41:01,274 - WARNING - Dropping gpid 2023100801_391 with 0 passers and 1 receivers
2025-12-11 22:41:01,290 - WARNING - Dropping gpid 2023101200_2306 with 0 passers and 1 receivers
2025-12-11 22:41:01,325 - WARNING - Dropping gpid 2023102208_2326 with 0 passers and 1 receivers
2025-12-11 22:41:01,342 - WARNING - Dropping gpid 2023102907_281 with 0 passers and 1 receivers
2025-12-11 22:41:01,472 - WARNING - Dropping gpid 2023121400_1904 with 0 passers and 1 receivers
2025-12-11 22:41:01,473 - WARNING - Dropping gpid 2023121400_2596 with 0 passers and 1 receivers
2025-12-11 22:41:01,474 - WARNING - Dropping gpid 2023121600_1352 with 0 passers and 1 receivers
2025-12-11 22:41:01,506 - WARNING - Dropping gpid 2023122407_1051 with 0 passers and 1 receivers
2025-12-11 22:41:01,530 - WARNING - Dropping gpid 2023123108_1819 with 0 passers and 1 receivers
2025-12-11 22:41:25,067 - INFO - Finished estimating ball path for 14091 plays
2025-12-11 22:41:28,037 - INFO - Loading team description info from cached parquet.
2025-12-11 22:41:28,182 - INFO - Dropping 2 plays with >4.0s ball airtime
2025-12-11 22:41:32,160 - INFO - Defender dataset built: 31891 rows, 12 cols
2025-12-11 22:41:32,330 - INFO - Trained model artifacts found.
2025-12-11 22:41:32,350 - INFO - Loaded model and metadata from /Users/lukeneuendorf/projects/nfl-big-data-bowl-2026/data/models/defender_reach
Filtering plays with over 4 defenders: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 126/126 [00:00<00:00, 145.34it/s]
2025-12-11 22:41:33,346 - INFO - Dropping 1400 plays with no defenders within 10 yards of the pass landing point
2025-12-11 22:41:38,178 - INFO - Final number of pass plays: 12691
Preparing samples for EPA model: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12691/12691 [01:49<00:00, 116.23it/s]
2025-12-11 22:43:27,373 - INFO - Starting model training
2025-12-11 22:43:32,595 - INFO - Epoch 01 | Train Loss: 0.803 | Val Loss: 0.764
2025-12-11 22:43:37,503 - INFO - Epoch 02 | Train Loss: 0.684 | Val Loss: 0.705
2025-12-11 22:43:42,435 - INFO - Epoch 03 | Train Loss: 0.623 | Val Loss: 0.634
2025-12-11 22:43:47,375 - INFO - Epoch 04 | Train Loss: 0.602 | Val Loss: 0.605
2025-12-11 22:43:52,298 - INFO - Epoch 05 | Train Loss: 0.588 | Val Loss: 0.606
2025-12-11 22:43:57,224 - INFO - Epoch 06 | Train Loss: 0.568 | Val Loss: 0.634
2025-12-11 22:44:02,175 - INFO - Epoch 07 | Train Loss: 0.561 | Val Loss: 0.590
2025-12-11 22:44:08,978 - INFO - Epoch 08 | Train Loss: 0.547 | Val Loss: 0.604
2025-12-11 22:44:13,841 - INFO - Epoch 09 | Train Loss: 0.540 | Val Loss: 0.574
2025-12-11 22:44:19,090 - INFO - Epoch 10 | Train Loss: 0.538 | Val Loss: 0.607
2025-12-11 22:44:25,292 - INFO - Epoch 11 | Train Loss: 0.534 | Val Loss: 0.577
2025-12-11 22:44:30,333 - INFO - Epoch 12 | Train Loss: 0.521 | Val Loss: 0.578
2025-12-11 22:44:35,323 - INFO - Epoch 13 | Train Loss: 0.518 | Val Loss: 0.583
2025-12-11 22:44:40,480 - INFO - Epoch 14 | Train Loss: 0.519 | Val Loss: 0.574
2025-12-11 22:44:45,404 - INFO - Epoch 15 | Train Loss: 0.506 | Val Loss: 0.574
2025-12-11 22:44:50,594 - INFO - Epoch 16 | Train Loss: 0.510 | Val Loss: 0.564
2025-12-11 22:44:55,496 - INFO - Epoch 17 | Train Loss: 0.506 | Val Loss: 0.572
2025-12-11 22:45:00,637 - INFO - Epoch 18 | Train Loss: 0.499 | Val Loss: 0.575
2025-12-11 22:45:06,081 - INFO - Epoch 19 | Train Loss: 0.496 | Val Loss: 0.567
2025-12-11 22:45:12,224 - INFO - Epoch 20 | Train Loss: 0.493 | Val Loss: 0.604
2025-12-11 22:45:17,620 - INFO - Epoch 21 | Train Loss: 0.492 | Val Loss: 0.553
2025-12-11 22:45:22,818 - INFO - Epoch 22 | Train Loss: 0.485 | Val Loss: 0.551
2025-12-11 22:45:27,699 - INFO - Epoch 23 | Train Loss: 0.484 | Val Loss: 0.595
2025-12-11 22:45:32,470 - INFO - Epoch 24 | Train Loss: 0.483 | Val Loss: 0.567
2025-12-11 22:45:37,334 - INFO - Epoch 25 | Train Loss: 0.475 | Val Loss: 0.563
2025-12-11 22:45:42,211 - INFO - Epoch 26 | Train Loss: 0.476 | Val Loss: 0.562
2025-12-11 22:45:47,128 - INFO - Epoch 27 | Train Loss: 0.472 | Val Loss: 0.547
2025-12-11 22:45:51,930 - INFO - Epoch 28 | Train Loss: 0.469 | Val Loss: 0.577
2025-12-11 22:45:56,729 - INFO - Epoch 29 | Train Loss: 0.462 | Val Loss: 0.549
2025-12-11 22:46:01,784 - INFO - Epoch 30 | Train Loss: 0.459 | Val Loss: 0.564
2025-12-11 22:46:06,611 - INFO - Epoch 31 | Train Loss: 0.453 | Val Loss: 0.556
2025-12-11 22:46:11,394 - INFO - Epoch 32 | Train Loss: 0.454 | Val Loss: 0.556
2025-12-11 22:46:11,394 - INFO - Early stopping triggered at epoch 32.
2025-12-11 22:46:11,395 - INFO - Restored best model with val loss: 0.5467
2025-12-11 22:46:16,433 - INFO - ===== Final EPA Model Evaluation =====
2025-12-11 22:46:16,433 - INFO - Split             MAE     SmoothL1          MSE         RMSE
2025-12-11 22:46:16,433 - INFO - ------------------------------------------------------------
2025-12-11 22:46:16,433 - INFO - Train          0.7537       0.4467       1.6288       1.2762
2025-12-11 22:46:16,433 - INFO - Val            0.8690       0.5467       2.1284       1.4589
2025-12-11 22:46:16,433 - INFO - Test           0.9006       0.5844       2.3245       1.5246
2025-12-11 22:53:59,408 - INFO - ===== Baseline EPA Model Evaluation (Predicting Average EPA) =====
2025-12-11 22:53:59,408 - INFO - Split             MAE     SmoothL1          MSE         RMSE
2025-12-11 22:53:59,408 - INFO - ------------------------------------------------------------
2025-12-11 22:53:59,408 - INFO - All            1.2070       0.7899       2.7227       1.6500
2025-12-11 22:46:16,433 - INFO - Model training and evaluation complete, saving the model
